# Git 提交信息助手（Git Commit Message Helper Agent）开发流程

## 概述

开发一个 IntelliJ IDEA 插件，用于帮助开发者规范化 Git 提交信息，提高团队协作效率。

---

## 步骤 1：需求分析与功能设计

**目标：** 明确插件要解决的问题，定义插件的功能和用户交互方式。

### 1.1 确定插件功能

- **自动生成提交信息模板**：根据用户的文件变动自动生成提交信息模板，提示合适的提交类型（如 feat、fix、docs）。
- **提交信息格式检查**：对用户输入的提交信息进行格式校验（如检查是否符合 Conventional Commits）。
- **提交信息建议**：根据历史提交记录、文件更改内容以及项目类型，给出提交信息的自动建议。
- **历史记录分析**：从历史提交中分析常用提交类型和关键词，帮助生成符合项目风格的提交信息。

### 1.2 确定用户交互方式

- 提供一个 Git 提交界面插件，支持在 IDEA 中编辑和生成提交信息。
- 提供下拉菜单或自动填充功能，帮助开发者选择合适的提交类型和描述。
- 实时校验提交信息格式，显示错误提示或警告。

### 1.3 确定支持的规范

- 是否支持常见的提交规范（如 Conventional Commits、Angular Commit Message Guidelines 等）。
- 是否允许用户自定义规范规则。

### 1.4 插件目标用户

- 主要面向开发者，尤其是团队合作项目中的开发人员，帮助确保提交信息符合规范。

---

## 步骤 2：创建 IntelliJ IDEA 插件项目

**目标：** 在 IntelliJ IDEA 中创建插件项目，并配置相关依赖。

### 2.1 创建插件项目

- 打开 IntelliJ IDEA，创建一个新的插件项目。
- 配置项目 SDK 为 IntelliJ IDEA SDK。
- 配置插件的元数据文件 `plugin.xml`，包括插件名称、描述、版本、开发者信息等。

### 2.2 配置项目依赖

- 在 `build.gradle` 或 `pom.xml` 中，配置插件所需的依赖（例如 Git 集成、UI 组件等）。
- 引入 IntelliJ IDEA 插件开发的核心 SDK。
- 配置插件的 Git 相关依赖，便于与 Git 仓库进行交互。

### 2.3 设置插件的入口点

- 配置 `plugin.xml` 中的扩展点（extension points），例如设置插件的菜单、工具栏按钮、Git 提交界面等。
- 设置插件的启动类，定义插件的初始化流程。

---

## 步骤 3：实现 Git 集成

**目标：** 通过 Git API 获取提交信息，分析文件变动，并生成合适的提交信息模板。

### 3.1 集成 Git 仓库

- 使用 IntelliJ 提供的 Git API（如 `GitRepositoryManager`、`GitCommitMessage` 等）集成 Git 功能。
- 获取当前 Git 仓库信息，判断是否为有效的 Git 仓库。
- 检测当前的 Git 状态，获取哪些文件被修改或添加。
- 提取当前文件的修改内容，并推断出提交的类型和内容。

### 3.2 文件变动分析

根据修改的文件类型推断提交类型，例如：
- `.js`、`.ts` 文件 → `feat`（新特性）
- `.py` 文件 → `fix`（修复 bug）
- `.md` 文件 → `docs`（文档更新）

根据文件变动的具体内容，给出一个提交信息模板，帮助用户快速生成提交信息。

---

## 步骤 4：提交信息模板生成

**目标：** 根据文件变动或用户选择自动生成提交信息模板。

### 4.1 模板生成规则

- 提供常见的提交类型（如 `feat`, `fix`, `docs`, `chore`）。
- 基于文件类型和修改内容生成合理的模板：

**示例模板：**
```
feat: 添加用户登录功能
fix: 修复用户登录错误
docs: 更新 README 文件
chore: 更新依赖
```

- 可以根据文件的具体改动（如增加的函数、修复的 bug）自动填充模板。

### 4.2 历史记录分析

- 从 Git 历史提交中提取常用提交类型和描述词，帮助生成符合项目风格的提交信息。
- 例如，如果历史提交中大量使用 `fix` 来描述修复 bug，则可以将 `fix` 作为默认选项。

### 4.3 模板与提示

- 在提交信息框中提供自动填充的提交信息模板，并允许用户根据实际变动进行修改。
- 可以通过在 Git 提交界面旁显示一个浮动的提示框或工具栏，向用户建议合适的提交类型和模板。

---

## 步骤 5：提交信息格式检查

**目标：** 对用户输入的提交信息进行格式校验，确保符合规范。

### 5.1 检查提交信息格式

使用正则表达式或自定义规则检查提交信息格式：
- 是否符合 `type: description` 格式。
- 是否使用了正确的提交类型（如 `feat`, `fix`, `docs` 等）。
- 是否在描述中包含简洁明了的说明。

例如，提交信息必须以 `feat:` 开头，且后面跟随简短的描述。

### 5.2 实时校验与提示

- 在提交信息框中提供实时格式校验功能，如果提交信息不符合规范，显示错误提示或警告信息。
- 提供建议或自动修复功能，帮助用户修改提交信息。

### 5.3 集成规范检查

- 提供配置选项，让用户选择是否启用提交规范检查，例如启用 Conventional Commits 或自定义规则。
- 用户可以根据团队的需求配置所需的提交规范。

---

## 步骤 6：UI 和用户交互设计

**目标：** 提供简洁易用的用户界面，帮助开发者高效编写规范的提交信息。

### 6.1 Git 提交界面集成

- 在 IntelliJ IDEA 的 Git 提交界面中，增强提交信息输入框，提供一个模板和自动填充功能。
- 可以通过自定义插件 UI 组件（如按钮、下拉菜单等）让用户选择提交类型（如 `feat`、`fix` 等）。

### 6.2 实时提交信息提示

- 在输入提交信息时，实时显示提交信息的格式检查结果。
- 如果发现格式不符合规范，立即给出反馈（如高亮显示、警告图标、提示框等）。

### 6.3 可配置选项

- 提供配置选项，允许用户根据项目需求自定义提交信息格式（如启用/禁用特定的提交类型，选择是否强制提交信息规范等）。

---

## 步骤 7：测试与调试

**目标：** 测试插件的功能和稳定性，确保其在不同场景下都能正常工作。

### 7.1 单元测试

- 为核心功能（如提交信息格式检查、模板生成、历史记录分析等）编写单元测试。
- 使用 JUnit 或其他测试框架来验证插件的正确性。

### 7.2 集成测试

- 在不同类型的 Git 仓库中进行测试，确保插件能与 Git 仓库正常交互。
- 在各种提交场景下（如新增功能、修复 bug、更新文档等）测试插件的表现。

### 7.3 IDEA 中调试

- 在 IntelliJ IDEA 中运行插件，模拟用户的提交操作，确保插件正常工作并提供适当的提示和反馈。

---

## 步骤 8：发布与维护

**目标：** 将插件发布到 JetBrains 插件库，并定期更新和维护插件。

### 8.1 打包与发布

- 将插件打包成 `.zip` 文件，上传到 JetBrains Plugin Repository。
- 确保插件在 IDEA 插件市场上可以被找到，并且能够正常安装和使用。

### 8.2 文档与支持

- 编写用户手册或使用文档，帮助用户了解如何使用插件的各项功能。
- 提供常见问题解答（FAQ）和支持渠道，帮助用户解决使用中的问题。

### 8.3 定期维护

- 根据用户反馈修复 bug，发布新版本以提高插件的稳定性。
- 根据新的 Git 提交规范或用户需求，更新插件功能。

---

## 总结

通过以上步骤，可以完成一个功能完善的 Git 提交信息助手插件，帮助开发者规范化提交信息，提高代码管理质量和团队协作效率。
